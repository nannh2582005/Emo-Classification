\chapter{XÃ‚Y Dá»°NG MÃ” HÃŒNH PHÃ‚N TÃCH}

\section{Module Loader}
\subsection{CÃ¡c thÆ° viá»‡n chÃ­nh}

Há»‡ thá»‘ng sá»­ dá»¥ng cÃ¡c thÆ° viá»‡n mÃ£ nguá»“n má»Ÿ sau:

\begin{itemize}
    \item \textbf{Scikit-learn (sklearn):} 
    ThÆ° viá»‡n cá»‘t lÃµi dÃ¹ng Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y nhÆ° 
    \textit{Logistic Regression}, \textit{Naive Bayes} vÃ  \textit{SVM}. 
    ThÆ° viá»‡n cung cáº¥p Ä‘áº§y Ä‘á»§ cÃ´ng cá»¥ Ä‘á»ƒ:
    \begin{itemize}
        \item trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng vÄƒn báº£n báº±ng \textit{TF--IDF Vectorizer};
        \item tiá»n xá»­ lÃ½ dá»¯ liá»‡u (train--test split, chuáº©n hÃ³a);
        \item huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh.
    \end{itemize}

    CÃ¡c tham sá»‘ quan trá»ng thÆ°á»ng dÃ¹ng:
    \begin{itemize}
        \item \texttt{C} (SVM): Ä‘iá»u chá»‰nh má»©c pháº¡t khi mÃ´ hÃ¬nh phÃ¢n loáº¡i sai;
        \item \texttt{kernel} (SVM): lá»±a chá»n hÃ m nhÃ¢n (\textit{linear}, \textit{rbf}, \dots);
        \item \texttt{alpha} (Naive Bayes): há»‡ sá»‘ lÃ m trÆ¡n Laplace;
        \item \texttt{max\_features} (TF--IDF): giá»›i háº¡n sá»‘ lÆ°á»£ng Ä‘áº·c trÆ°ng.
    \end{itemize}

    \item \textbf{Pandas:} 
    DÃ¹ng Ä‘á»ƒ Ä‘á»c dá»¯ liá»‡u tá»« cÃ¡c Ä‘á»‹nh dáº¡ng nhÆ° \texttt{.csv} vÃ  \texttt{.xlsx},
    Ä‘á»“ng thá»i há»— trá»£ thao tÃ¡c linh hoáº¡t trÃªn \textit{DataFrame} 
    (lá»c, gá»™p, thá»‘ng kÃª, biáº¿n Ä‘á»•i dá»¯ liá»‡u).

    Tham sá»‘ quan trá»ng:
    \begin{itemize}
        \item \texttt{read\_csv()}, \texttt{read\_excel()}: Ä‘á»c dá»¯ liá»‡u;
        \item \texttt{dropna()}: loáº¡i bá» hÃ ng bá»‹ thiáº¿u;
        \item \texttt{astype()}: chuyá»ƒn kiá»ƒu dá»¯ liá»‡u.
    \end{itemize}

    \item \textbf{PyVi:}
    ThÆ° viá»‡n xá»­ lÃ½ tiáº¿ng Viá»‡t chuyÃªn dá»¥ng, dÃ¹ng Ä‘á»ƒ tÃ¡ch tá»« (\textit{tokenization}),
    giÃºp vÄƒn báº£n tiáº¿ng Viá»‡t Ä‘Æ°á»£c phÃ¢n chia theo cá»¥m tá»« cÃ³ nghÄ©a trÆ°á»›c khi Ä‘Æ°a vÃ o mÃ´ hÃ¬nh. 
    Äiá»u nÃ y cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c cá»§a TF--IDF vÃ  mÃ´ hÃ¬nh phÃ¢n loáº¡i.

    PhÆ°Æ¡ng thá»©c chÃ­nh:
    \begin{itemize}
        \item \texttt{ViTokenizer.tokenize(sentence)}: tÃ¡ch tá»« trong cÃ¢u Ä‘áº§u vÃ o.
    \end{itemize}

    \item \textbf{Joblib:}
    DÃ¹ng Ä‘á»ƒ tuáº§n tá»± hÃ³a (serialize) mÃ´ hÃ¬nh Ä‘Ã£ huáº¥n luyá»‡n vÃ  lÆ°u xuá»‘ng Ä‘Ä©a,
    cho phÃ©p tÃ¡i sá»­ dá»¥ng mÃ´ hÃ¬nh mÃ  khÃ´ng cáº§n huáº¥n luyá»‡n láº¡i.

    HÃ m quan trá»ng:
    \begin{itemize}
        \item \texttt{joblib.dump(model, path)}: lÆ°u mÃ´ hÃ¬nh;
        \item \texttt{joblib.load(path)}: táº£i mÃ´ hÃ¬nh.
    \end{itemize}

    \item \textbf{Matplotlib \& Seaborn:}
    Hai thÆ° viá»‡n trá»±c quan hÃ³a dá»¯ liá»‡u giÃºp váº½ cÃ¡c biá»ƒu Ä‘á»“ thá»‘ng kÃª 
    vÃ  ma tráº­n nháº§m láº«n (\textit{Confusion Matrix}).  
    Trong Ä‘á»“ Ã¡n, nhÃ³m sá»­ dá»¥ng chÃºng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ trá»±c quan hiá»‡u nÄƒng mÃ´ hÃ¬nh.

    CÃ¡c hÃ m phá»• biáº¿n:
    \begin{itemize}
        \item \texttt{plt.figure(figsize)}: táº¡o khung hÃ¬nh;
        \item \texttt{sns.heatmap()}: váº½ ma tráº­n nháº§m láº«n;
        \item \texttt{plt.xlabel()}, \texttt{plt.ylabel()}: thÃªm nhÃ£n trá»¥c.
    \end{itemize}

    \item \textbf{OpenPyXL:}
    ThÆ° viá»‡n há»— trá»£ Ä‘á»c vÃ  ghi dá»¯ liá»‡u vÃ o Ä‘á»‹nh dáº¡ng Excel (\texttt{.xlsx}),
    Ä‘Æ°á»£c sá»­ dá»¥ng khi bá»™ dá»¯ liá»‡u ban Ä‘áº§u á»Ÿ dáº¡ng Excel hoáº·c khi cáº§n xuáº¥t dá»¯ liá»‡u Ä‘Ã£ xá»­ lÃ½.

    HÃ m quan trá»ng:
    \begin{itemize}
        \item \texttt{load\_workbook()}: Ä‘á»c file Excel;
        \item \texttt{worksheet.append()}: thÃªm dÃ²ng dá»¯ liá»‡u;
        \item \texttt{workbook.save()}: lÆ°u tá»‡p Excel.
    \end{itemize}

\end{itemize}

%-----------------------------------
\section{Module Preprocessor}
\section{Tiá»n xá»­ lÃ½ dá»¯ liá»‡u}

Tiá»n xá»­ lÃ½ lÃ  má»™t bÆ°á»›c thiáº¿t yáº¿u trÆ°á»›c khi Ä‘i vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n mÃ´ hÃ¬nh. Äáº·c biá»‡t hÆ¡n, trong mÃ´i trÆ°á»ng trá»±c tuyáº¿n trÃªn máº¡ng xÃ£ há»™i, cÃ¡c tÃ i liá»‡u thÆ°á»ng khÃ´ng Ä‘Æ°á»£c viáº¿t báº±ng vÄƒn báº£n chÃ­nh thá»©c. Äiá»u nÃ y Ä‘áº·c biá»‡t Ä‘Ãºng vá»›i thanh thiáº¿u niÃªn, nhá»¯ng ngÆ°á»i thÆ°á»ng sá»­ dá»¥ng nhiá»u biá»ƒu tÆ°á»£ng cáº£m xÃºc, dáº¡ng rÃºt gá»n cá»§a tá»«, kÃ½ hiá»‡u vÃ  kÃ½ tá»± Ä‘áº·c biá»‡t, tá»« viáº¿t sai chÃ­nh táº£, lá»—i ngá»¯ phÃ¡p, hoáº·c tá»« ghÃ©p. TrÆ°á»›c khi Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ´ hÃ¬nh, dá»¯ liá»‡u pháº£i tráº£i qua cÃ¡c bÆ°á»›c tiá»n xá»­ lÃ½ cáº§n thiáº¿t.

\subsection{XÃ³a cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t}
CÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t khÃ´ng mang Ã½ nghÄ©a phÃ¢n loáº¡i vÃ  cÃ³ thá»ƒ gÃ¢y nhiá»…u trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch.

\subsection{Chuyá»ƒn vá» chá»¯ thÆ°á»ng}
Má»—i sá»‘ vÃ  kÃ½ tá»± Ä‘áº·c biá»‡t Ä‘á»u Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng má»™t dÃ£y nhá»‹ phÃ¢n trong bá»™ nhá»› mÃ¡y tÃ­nh. Chá»¯ in hoa vÃ  chá»¯ thÆ°á»ng cÃ³ mÃ£ Unicode khÃ¡c nhau, dÃ¹ vá» máº·t ngá»¯ nghÄ©a lÃ  giá»‘ng nhau, nhÆ°ng mÃ¡y tÃ­nh cÃ³ thá»ƒ khÃ´ng phÃ¢n biá»‡t Ä‘Æ°á»£c trong dá»¯ liá»‡u Ä‘áº§u vÃ o, dáº«n Ä‘áº¿n káº¿t quáº£ dá»± Ä‘oÃ¡n bá»‹ áº£nh hÆ°á»Ÿng. Do Ä‘Ã³, viá»‡c chuyá»ƒn táº¥t cáº£ chá»¯ vá» dáº¡ng chá»¯ thÆ°á»ng lÃ  há»£p lÃ½ cho há»‡ thá»‘ng phÃ¢n tÃ­ch vÃ  dá»± Ä‘oÃ¡n.

\subsection{Loáº¡i bá» stopword}
Trong tiáº¿ng Viá»‡t lÃ  cÃ¡c tá»« nhÆ° \textit{cÃ¡i, cÃ¡c, cáº£, ...}. CÃ¡c tá»« nÃ y thÆ°á»ng sáº½ Ä‘Æ°á»£c loáº¡i bá» Ä‘á»ƒ giáº£m kÃ­ch thÆ°á»›c cá»§a bá»™ tá»« vá»±ng. NhÃ³m dÃ¹ng bá»™ dá»¯ liá»‡u stopword Ä‘Æ°á»£c tá»•ng há»£p bá»Ÿi Van-Duyet Le.

\textbf{Link dá»¯ liá»‡u gá»‘c:} \url{https://github.com/stopwords/vietnamese-stopwords}

\subsection{Unicode}
Chuáº©n hÃ³a dá»¯ liá»‡u vá» dáº¡ng Unicode.

\subsection{GÃ¡n nhÃ£n dá»¯ liá»‡u}
NhÆ° Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ má»¥c 2.1.

\subsection{Xá»­ lÃ½ dá»¯ liá»‡u khuyáº¿t}
Táº­p dá»¯ liá»‡u thu tháº­p cÃ³ thá»ƒ chá»©a nhiá»u dÃ²ng dá»¯ liá»‡u trá»‘ng, vÃ  dá»¯ liá»‡u trá»‘ng khÃ´ng cÃ³ Ã½ nghÄ©a trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch, gÃ¢y lÃ£ng phÃ­ bá»™ nhá»› lÆ°u trá»¯. Äá»‘i vá»›i báº£n ghi bá»‹ khuyáº¿t nhÃ£n, nhÃ³m quy Ä‘á»‹nh gÃ¡n nhÃ£n \textbf{Other} (tá»©c Trung tÃ­nh) cho dá»¯ liá»‡u Ä‘Ã³.

\subsection{Tokenization (tÃ¡ch tá»«)}
Tokenization lÃ  bÆ°á»›c tÃ¡ch cÃ¢u hoáº·c vÄƒn báº£n thÃ nh cÃ¡c Ä‘Æ¡n vá»‹ nhá» hÆ¡n (token), thÆ°á»ng lÃ  tá»«, cá»¥m tá»« hoáº·c kÃ½ tá»±. ÄÃ¢y lÃ  bÆ°á»›c quan trá»ng nháº¥t trong xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn vÃ¬ háº§u háº¿t cÃ¡c phÆ°Æ¡ng phÃ¡p vectorization (One-hot, TF-IDF, ...) Ä‘á»u yÃªu cáº§u Ä‘áº§u vÃ o lÃ  danh sÃ¡ch token.

Tiáº¿ng Viá»‡t lÃ  ngÃ´n ngá»¯ Ä‘Æ¡n láº­p, trong Ä‘Ã³ nhiá»u tá»« Ä‘Æ°á»£c cáº¥u thÃ nh tá»« nhiá»u Ã¢m tiáº¿t vÃ  Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u cÃ¡ch (vÃ­ dá»¥: \textit{há»c sinh, cÃ´ng nghá»‡ thÃ´ng tin}). Do Ä‘Ã³, viá»‡c tokenization Ä‘Æ¡n giáº£n dá»±a trÃªn dáº¥u cÃ¡ch sáº½ khÃ´ng Ä‘áº£m báº£o Ä‘Æ°á»£c tÃ­nh chÃ­nh xÃ¡c vá» máº·t ngá»¯ nghÄ©a. Äá»ƒ kháº¯c phá»¥c háº¡n cháº¿ nÃ y, nhÃ³m sá»­ dá»¥ng \textbf{ViTokenizer} trong thÆ° viá»‡n \texttt{pyvi}, má»™t cÃ´ng cá»¥ tokenization chuyÃªn biá»‡t cho tiáº¿ng Viá»‡t, cÃ³ kháº£ nÄƒng nháº­n diá»‡n vÃ  ghÃ©p cÃ¡c cá»¥m tá»« Ä‘a Ã¢m tiáº¿t má»™t cÃ¡ch chÃ­nh xÃ¡c. Äáº§u ra sau khi tokenize cÃ³ dáº¡ng \textit{há»c\_sinh}, ...

\subsection{MÃ£ hÃ³a nhÃ£n dÃ¡n}
Chuyá»ƒn nhÃ£n dÃ¡n thÃ nh cÃ¡c mÃ£ sá»‘ tá»« 0 Ä‘áº¿n 2 tÆ°Æ¡ng á»©ng vá»›i:
\begin{itemize}
    \item 0: TÃ­ch cá»±c
    \item 1: TiÃªu cá»±c
    \item 2: Trung tÃ­nh
\end{itemize}

\subsection{Chuyá»ƒn hÃ³a emoji vÃ  teencode}
Trong cÃ¡c vÄƒn báº£n thu tháº­p tá»« máº¡ng xÃ£ há»™i, emoji xuáº¥t hiá»‡n vá»›i táº§n suáº¥t cao, Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c thá»ƒ hiá»‡n cáº£m xÃºc cá»§a ngÆ°á»i viáº¿t, Ä‘áº·c biá»‡t Ä‘á»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i cáº£m xÃºc. Tuy nhiÃªn, Ä‘a sá»‘ mÃ´ hÃ¬nh há»c mÃ¡y vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p biá»ƒu diá»…n Ä‘áº·c trÆ°ng khÃ´ng thá»ƒ xá»­ lÃ½ trá»±c tiáº¿p biá»ƒu tÆ°á»£ng nÃ y. VÃ¬ váº­y, viá»‡c chuyá»ƒn hÃ³a chÃºng thÃ nh vÄƒn báº£n cÃ³ Ã½ nghÄ©a lÃ  bÆ°á»›c cáº§n thiáº¿t nháº±m báº£o toÃ n thÃ´ng tin cáº£m xÃºc vÃ  Ä‘áº£m báº£o tÃ­nh kháº£ dá»¥ng cá»§a dá»¯ liá»‡u khi Ä‘Æ°a vÃ o mÃ´ hÃ¬nh.

\subsubsection{Chuyá»ƒn hÃ³a emoji}
Emoji cÃ³ thá»ƒ truyá»n táº£i cáº£m xÃºc rÃµ rá»‡t. NhÃ³m thá»±c hiá»‡n Ã¡nh xáº¡ tá»«ng emoji sang má»™t nhÃ£n vÄƒn báº£n tÆ°Æ¡ng á»©ng, cháº³ng háº¡n:

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/emoji.png}
    \caption{Má»™t sá»‘ nhÃ£n dÃ¡n emoji minh há»a}
    \label{fig:emoji_mapping}
\end{figure}

\subsubsection{Chuyá»ƒn hÃ³a teencode}
Teencode lÃ  hÃ¬nh thá»©c viáº¿t táº¯t, biáº¿n thá»ƒ hoáº·c mÃ£ hÃ³a trong giao tiáº¿p cá»§a giá»›i tráº». Náº¿u khÃ´ng chuáº©n hÃ³a, nhá»¯ng tá»« nÃ y sáº½ bá»‹ xem nhÆ° token riÃªng biá»‡t, lÃ m tÄƒng kÃ­ch thÆ°á»›c tá»« vá»±ng vÃ  gÃ¢y nhiá»…u. NhÃ³m xÃ¢y dá»±ng báº£ng tá»« Ä‘iá»ƒn teencode phá»• biáº¿n vÃ  thá»±c hiá»‡n Ã¡nh xáº¡ chÃºng vá» dáº¡ng tiáº¿ng Viá»‡t chuáº©n, giÃºp giáº£m sá»‘ lÆ°á»£ng token khÃ´ng cáº§n thiáº¿t.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/teencode.png}
    \caption{Má»™t sá»‘ tá»« teencode Ä‘Æ°á»£c chuáº©n hÃ³a }
    \label{fig:teencode_mapping}
\end{figure}

\subsection{Chuáº©n hoÃ¡ tá»« láº·p}

Trong vÄƒn báº£n thu tháº­p tá»« máº¡ng xÃ£ há»™i, Ä‘áº·c biá»‡t lÃ  vÄƒn báº£n thá»ƒ hiá»‡n cáº£m xÃºc, nhá»¯ng tá»« Ä‘Æ°á»£c cá»‘ Ã½ kÃ©o dÃ i (vÃ­ dá»¥: ``Ä‘á»‰nnnhhhhh'', ``Ä‘áº¹ppppp'', ``huuuuuu'') thÆ°á»ng mang tÃ­nh nháº¥n máº¡nh vÃ  biá»ƒu Ä‘áº¡t má»©c Ä‘á»™ cáº£m xÃºc máº¡nh hÆ¡n so vá»›i dáº¡ng tá»« gá»‘c. Tuy nhiÃªn, dáº¡ng kÃ©o dÃ i nÃ y táº¡o ra sá»± Ä‘a dáº¡ng khÃ´ng cáº§n thiáº¿t trong khÃ´ng gian Ä‘áº·c trÆ°ng vÃ  lÃ m tÄƒng Ä‘á»™ nhiá»…u cá»§a dá»¯ liá»‡u. Do Ä‘Ã³ cáº§n chuáº©n hoÃ¡ cÃ¡c tá»« kÃ©o dÃ i vá» dáº¡ng chuáº©n (vÃ­ dá»¥: Ä‘á»‰nnnhhhhh $\rightarrow$ Ä‘á»‰nh, Ä‘áº¹ppppppp $\rightarrow$ Ä‘áº¹p, ...) nháº±m giáº£m sá»‘ lÆ°á»£ng biáº¿n thá»ƒ khÃ´ng cÃ³ giÃ¡ trá»‹ ngá»¯ nghÄ©a bá»• sung.

\subsection{Káº¿t quáº£ sau khi qua quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½}

Vá»›i dá»¯ liá»‡u Ä‘áº§u vÃ o lÃ :

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Ä‘áº§u vÃ o processor.png}
    \caption{Dá»¯ liá»‡u Ä‘áº§u vÃ o cá»§a module processor}
    \label{fig:input_processor}
\end{figure}

Dá»¯ liá»‡u sau khi tiá»n xá»­ lÃ½:

\begin{table}[H]
\centering
\caption{Má»™t sá»‘ dÃ²ng dá»¯ liá»‡u sau khi tiá»n xá»­ lÃ½}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{c c c l c c l}
\hline
\textbf{No} & \textbf{unnamed} & \textbf{Emotion} & \textbf{Sentence} 
& \textbf{merged\_label} & \textbf{label\_id} & \textbf{processed} \\
\hline

0 & 0 & Disgust & há»i nháº¡y khiáº¿p 
& TiÃªu cá»±c & 1 & {[}â€œnháº¡yâ€, â€œkhiáº¿pâ€{]} \\

2 & 1944 & Surprise & con ngÆ°á»i giá»i nhá»‰ .
& TÃ­ch cá»±c & 0 & {[}â€œcon\_ngÆ°á»iâ€, â€œgiá»iâ€{]} \\

3 & 1711 & Other & mÃ¡ 2 tháº±ng Ã¡o vÃ ng láº§y ghÃª ğŸ¤ª
& Trung tÃ­nh & 2 & {[}â€œmÃ¡â€, â€œ2â€, â€œtháº±ngâ€, â€œÃ¡oâ€, â€œvÃ ngâ€, â€œláº§yâ€, â€œghÃªâ€, â€œtrung\_tÃ­nhâ€{]} \\

\hline
\end{tabular}
\end{table}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/KQ module TXL.png}
    \caption{ Káº¿t quáº£ cháº¡y module tiá»n xá»­ lÃ½ }
    \label{fig:output_processor}
\end{figure}

%------------------------------------
\section{Module feature}
Lá»›p cÆ¡ sá»Ÿ trá»«u tÆ°á»£ng (base.py)

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/dataFeature.png}
    \caption{ÄÃ¢y lÃ  khung sÆ°á»n cho má»i thuáº­t toÃ¡n trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng trong há»‡ thá»‘ng}
    \label{fig:data_feature}
\end{figure}

\begin{itemize}
    \item \textbf{TÃªn lá»›p:} \texttt{DataFeature}
    \item \textbf{Káº¿ thá»«a:} \texttt{ABC} (Abstract Base Class) tá»« thÆ° viá»‡n chuáº©n Python.
    \item \textbf{Chá»©c nÄƒng chÃ­nh:}
    \begin{enumerate}
        \item \textbf{Thá»‘ng kÃª dá»¯ liá»‡u:} Ngay khi khá»Ÿi táº¡o, lá»›p nÃ y tá»± Ä‘á»™ng tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng tá»« vá»±ng (Vocabulary Size) vÃ  tá»•ng sá»‘ lÆ°á»£ng token trong táº­p dá»¯ liá»‡u. Äiá»u nÃ y giÃºp ngÆ°á»i láº­p trÃ¬nh náº¯m báº¯t Ä‘Æ°á»£c Ä‘á»™ phá»©c táº¡p cá»§a dá»¯ liá»‡u Ä‘áº§u vÃ o.
        \item \textbf{Äá»‹nh nghÄ©a giao diá»‡n (Interface):} Báº¯t buá»™c cÃ¡c lá»›p con pháº£i triá»ƒn khai hai phÆ°Æ¡ng thá»©c cá»‘t lÃµi lÃ  \texttt{fit()} vÃ  \texttt{transform()}.
    \end{enumerate}
\end{itemize}

Lá»›p triá»ƒn khai TF-IDF (tfidf.py)

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/TFIDF_DF.png} % nhá»› Ä‘á»•i tÃªn file ngoÃ i thÆ° má»¥c
    \caption{Lá»›p trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng TF-IDF káº¿ thá»«a tá»« lá»›p cÆ¡ sá»Ÿ DataFeature}
    \label{fig:tfidf_feature}
\end{figure}

ÄÃ¢y lÃ  lá»›p káº¿ thá»«a tá»« \texttt{DataFeature}, thá»±c hiá»‡n ká»¹ thuáº­t TF--IDF 
(Term Frequency -- Inverse Document Frequency).

\begin{itemize}
    \item \textbf{TÃªn lá»›p:} \texttt{TFIDF}
    \item \textbf{ThÆ° viá»‡n sá»­ dá»¥ng:} \texttt{TfidfVectorizer} cá»§a Scikit-learn.
    \item \textbf{Äiá»ƒm ká»¹ thuáº­t Ä‘áº·c biá»‡t:}
    \begin{enumerate}[label=\alph*.]
        \item \textbf{Xá»­ lÃ½ Ä‘áº§u vÃ o Ä‘Ã£ tÃ¡ch tá»« (Pre-tokenized Input):}  
        VÃ¬ dá»¯ liá»‡u Ä‘áº§u vÃ o (tá»« \texttt{DataProcessor}) Ä‘Ã£ Ä‘Æ°á»£c tÃ¡ch thÃ nh danh sÃ¡ch cÃ¡c tá»« 
        (list of tokens), nÃªn \texttt{TfidfVectorizer} Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘áº·c biá»‡t Ä‘á»ƒ khÃ´ng tÃ¡ch tá»« láº¡i láº§n ná»¯a.
        
        \item \textbf{Xá»­ lÃ½ Ä‘áº§u vÃ o Ä‘Ã£ tÃ¡ch tá»«:}  
        Náº¿u dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Ã£ á»Ÿ dáº¡ng list of tokens, 
        \texttt{TfidfVectorizer} Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ nháº­n trá»±c tiáº¿p danh sÃ¡ch nÃ y 
        mÃ  khÃ´ng thá»±c hiá»‡n láº¡i bÆ°á»›c tÃ¡ch tá»«.
    \end{enumerate}

    \item \textbf{Cáº¥u hÃ¬nh linh hoáº¡t:}  
    CÃ¡c tham sá»‘ quan trá»ng Ä‘Æ°á»£c láº¥y tá»« file \texttt{config.py} thay vÃ¬ gÃ¡n cá»©ng (hard-code),
    giÃºp dá»… dÃ ng tinh chá»‰nh mÃ´ hÃ¬nh:
    \begin{itemize}
        \item \texttt{max\_features}: Giá»›i háº¡n sá»‘ lÆ°á»£ng tá»« vá»±ng quan trá»ng nháº¥t (vÃ­ dá»¥: 5000 tá»«).
        \item \texttt{ngram\_range}: Sá»­ dá»¥ng cáº£ tá»« Ä‘Æ¡n (unigram) vÃ  cá»¥m tá»« (bigram, trigram).
    \end{itemize}

    \item \textbf{Quáº£n lÃ½ lá»—i vÃ  Log:}  
    Sá»­ dá»¥ng khá»‘i try--except vÃ  há»‡ thá»‘ng logger Ä‘á»ƒ ghi nháº­n quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng hoáº·c bÃ¡o lá»—i chi tiáº¿t náº¿u quÃ¡ trÃ¬nh vector hÃ³a gáº·p váº¥n Ä‘á».
\end{itemize}

%------------------------------------
\section{Tá»‘i Æ°u tham sá»‘}
\subsection{Logistic Regression}
% Ná»™i dung 3.4.1

\subsection{Support Vector Machine}
Trong bÃ i toÃ¡n phÃ¢n loáº¡i cáº£m xÃºc, hiá»‡u quáº£ cá»§a mÃ´ hÃ¬nh SVM phá»¥ thuá»™c Ä‘Ã¡ng ká»ƒ vÃ o bá»™ 
tham sá»‘ siÃªu (hyperparameters) nhÆ° \textbf{kernel}, \textbf{C}, vÃ  \textbf{gamma}. Do Ä‘Ã³, nhÃ³m xÃ¢y dá»±ng module 
\texttt{SVMOptimizer} nháº±m tá»± Ä‘á»™ng tÃ¬m táº­p tham sá»‘ tá»‘t nháº¥t cho mÃ´ hÃ¬nh thÃ´ng qua phÆ°Æ¡ng phÃ¡p 
\texttt{GridSearchCV} káº¿t há»£p Ä‘Ã¡nh giÃ¡ chÃ©o (Cross-Validation).

Má»¥c tiÃªu: thiáº¿t láº­p lÆ°á»›i tham sá»‘ (parameter grid) cho SVM -> tÃ¬m kiáº¿m tá»‘i Æ°u báº±ng 
GridSearchCV vá»›i thÆ°á»›c Ä‘o \texttt{f1\_macro} (giÃºp Ä‘áº£m báº£o mÃ´ hÃ¬nh há»c tá»‘t táº¥t cáº£ cÃ¡c lá»›p mÃ  
khÃ´ng chá»‰ lá»›p lá»›n) => mÃ´ hÃ¬nh Ä‘áº¡t hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh hÆ¡n so vá»›i viá»‡c thá»§ cÃ´ng.

CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a \texttt{SVMOptimizer}:
Khi khá»Ÿi táº¡o: lá»›p \texttt{SVMOptimizer} nháº­n cÃ¡c tham sá»‘:
\begin{itemize}
    \item X, y lÃ  táº­p Ä‘áº·c trÆ°ng vÃ  nhÃ£n
    \item config: chá»©a cÃ¡c thÃ´ng sá»‘ chung cá»§a há»‡ thá»‘ng (random\_state, test\_size)
    \item khá»Ÿi táº¡o bá»™ ghi log Ä‘á»ƒ theo dÃµi tiáº¿n trÃ¬nh tá»‘i Æ°u
\end{itemize}

CÃ¡c tham sá»‘ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:

\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{Tham sá»‘ tá»‘i Æ°u} & \textbf{Thá»­ nghiá»‡m cÃ¡c giÃ¡ trá»‹} \\
\hline
kernel & linear, rbf, poly \\
\hline
C & 0.1, 1, 10 \\
\hline
gamma & scale, auto \\
\hline
\end{tabular}
\end{center}

Vá»›i:
\begin{itemize}
    \item kernel: quyáº¿t Ä‘á»‹nh hÃ¬nh dáº¡ng siÃªu pháº³ng
    \item C: Ä‘iá»u chá»‰nh má»©c pháº¡t Ä‘á»‘i vá»›i lá»—i phÃ¢n loáº¡i
    \item gamma: xÃ¡c Ä‘á»‹nh má»©c áº£nh hÆ°á»Ÿng cá»§a tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u
\end{itemize}

Tá»‘i Æ°u tham sá»‘ báº±ng GridSearchCV:
\begin{itemize}
    \item Káº¿t há»£p toÃ n bá»™ cÃ¡c giÃ¡ trá»‹ trong lÆ°á»›i tham sá»‘
    \item huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh trÃªn tá»«ng tá»• há»£p
    \item sá»­ dá»¥ng k-fold cross-validation (máº·c Ä‘á»‹nh 5-fold) Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»—i tá»• há»£p
    \item chá»n tá»• há»£p tham sá»‘ cho Ä‘iá»ƒm \texttt{f1\_macro} cao nháº¥t
\end{itemize}

Káº¿t quáº£ tráº£ ra:
\begin{itemize}
    \item \texttt{best\_params\_}: tham sá»‘ tá»‘i Æ°u
    \item \texttt{best\_score\_}: Ä‘iá»ƒm \texttt{f1\_macro} cao nháº¥t Ä‘áº¡t Ä‘Æ°á»£c
\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/SVM_op.png}
    \caption{Káº¿t quáº£ tá»‘i Æ°u tham sá»‘ cá»§a mÃ´ hÃ¬nh SVM}
    \label{fig:log_svm}
\end{figure}

\subsection{Naive Bayes}

Trong bÃ i toÃ¡n phÃ¢n loáº¡i cáº£m xÃºc, Ä‘á»™ hiá»‡u quáº£ cá»§a mÃ´ hÃ¬nh Naive Bayes phá»¥ thuá»™c Ä‘Ã¡ng ká»ƒ vÃ o
siÃªu tham sá»‘ (hyperparameter) \texttt{alpha}. Do Ä‘Ã³, nhÃ³m xÃ¢y dá»±ng module 
\texttt{NaiveBayesOptimizer} nháº±m thá»­ nghiá»‡m vÃ  tÃ¬m giÃ¡ trá»‹ \texttt{alpha} tá»‘i Æ°u nháº¥t thÃ´ng qua 
ká»¹ thuáº­t GridSearchCV káº¿t há»£p Ä‘Ã¡nh giÃ¡ chÃ©o (Cross-Validation).

Má»¥c tiÃªu: thiáº¿t láº­p lÆ°á»›i tham sá»‘ (parameter grid) cho Naive Bayes â†’ tÃ¬m kiáº¿m tá»‘i Æ°u báº±ng 
GridSearchCV vá»›i thÆ°á»›c Ä‘o \texttt{f1\_macro} (giÃºp Ä‘áº£m báº£o mÃ´ hÃ¬nh há»c tá»‘t táº¥t cáº£ cÃ¡c lá»›p chá»© 
khÃ´ng chá»‰ lá»›p lá»›n) â‡’ mÃ´ hÃ¬nh Ä‘áº¡t hiá»‡u nÄƒng cao vÃ  á»•n Ä‘á»‹nh hÆ¡n so vá»›i viá»‡c thá»­ thá»§ cÃ´ng.

CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a \texttt{NaiveBayesOptimizer}:

Khi khá»Ÿi táº¡o, lá»›p \texttt{NaiveBayesOptimizer} nháº­n cÃ¡c tham sá»‘:
\begin{itemize}
    \item X, y: táº­p Ä‘áº·c trÆ°ng vÃ  nhÃ£n.
    \item config: chá»©a cÃ¡c thÃ´ng sá»‘ chung cá»§a há»‡ thá»‘ng (random\_state, test\_size).
    \item khá»Ÿi táº¡o bá»™ ghi log Ä‘á»ƒ theo dÃµi tiáº¿n trÃ¬nh tá»‘i Æ°u.
\end{itemize}

CÃ¡c tham sá»‘ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:

\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{Tham sá»‘ tá»‘i Æ°u} & \textbf{Thá»­ nghiá»‡m cÃ¡c giÃ¡ trá»‹} \\
\hline
alpha & 0.01, 0.1, 1.0 \\
\hline
\end{tabular}
\end{center}

Vá»›i:
\begin{itemize}
    \item \texttt{alpha}: há»‡ sá»‘ lÃ m trÆ¡n (smoothing) giÃºp trÃ¡nh viá»‡c xÃ¡c suáº¥t báº±ng 0 Ä‘á»‘i vá»›i 
    nhá»¯ng tá»« hiáº¿m trong dá»¯ liá»‡u.
\end{itemize}

Tá»‘i Æ°u tham sá»‘ báº±ng GridSearchCV:
\begin{itemize}
    \item Káº¿t há»£p toÃ n bá»™ cÃ¡c giÃ¡ trá»‹ trong lÆ°á»›i tham sá»‘.
    \item Huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh trÃªn tá»«ng tá»• há»£p.
    \item Sá»­ dá»¥ng k-fold cross-validation (máº·c Ä‘á»‹nh 5-fold) Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»—i tá»• há»£p.
    \item Chá»n tá»• há»£p tham sá»‘ cho Ä‘iá»ƒm \texttt{f1\_macro} cao nháº¥t.
\end{itemize}

Káº¿t quáº£ tráº£ ra:
\begin{itemize}
    \item \texttt{best\_params\_}: tham sá»‘ tá»‘i Æ°u.
    \item \texttt{best\_score\_}: Ä‘iá»ƒm \texttt{f1\_macro} cao nháº¥t Ä‘áº¡t Ä‘Æ°á»£c.
\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/NB_op.png}
    \caption{Káº¿t quáº£ tá»‘i Æ°u tham sá»‘ cá»§a mÃ´ hÃ¬nh Naive Bayes}
    \label{fig:log_naive_bayes}
\end{figure}

Tá»« Ä‘Ã³, ta thu Ä‘Æ°á»£c tham sá»‘ tá»‘i Æ°u cho mÃ´ hÃ¬nh Naive Bayes: 
\texttt{alpha = 0.1} vá»›i Ä‘iá»ƒm \texttt{f1\_macro = 0.5220}.

%--------------------------------------------
\section{Huáº¥n luyá»‡n mÃ´ hÃ¬nh}

\subsection{Tá»‰ lá»‡ phÃ¢n chia (Split Ratio)}

Dá»¯ liá»‡u Ä‘Æ°á»£c chia thÃ nh 2 pháº§n tÃ¡ch biá»‡t vá»›i tá»‰ lá»‡ 80/20 (Ä‘Æ°á»£c cáº¥u hÃ¬nh trong \texttt{config.py}):

\begin{itemize}
    \item \textbf{Táº­p Huáº¥n luyá»‡n (Training Set - 80\%)}: DÃ¹ng Ä‘á»ƒ cho mÃ´ hÃ¬nh há»c cÃ¡c Ä‘áº·c trÆ°ng vÃ  tÃ¬m ra quy luáº­t.
    \begin{itemize}
        \item Sá»‘ lÆ°á»£ng: Khoáº£ng 4.992 máº«u.
    \end{itemize}

    \item \textbf{Táº­p Kiá»ƒm thá»­ (Test Set - 20\%)}: DÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ Ä‘á»™c láº­p hiá»‡u nÄƒng cá»§a mÃ´ hÃ¬nh sau khi há»c xong. Dá»¯ liá»‡u nÃ y mÃ´ hÃ¬nh chÆ°a tá»«ng nhÃ¬n tháº¥y trÆ°á»›c Ä‘Ã³ (Unseen Data).
    \begin{itemize}
        \item Sá»‘ lÆ°á»£ng: Khoáº£ng 1.249 máº«u.
    \end{itemize}
\end{itemize}

\subsection{Ká»¹ thuáº­t chia: Stratified Random Sampling (Láº¥y máº«u phÃ¢n táº§ng)}

ÄÃ¢y lÃ  Ä‘iá»ƒm ká»¹ thuáº­t quan trá»ng nháº¥t trong pháº§n chia dá»¯ liá»‡u cá»§a Ä‘á»“ Ã¡n nÃ y.

\begin{itemize}
    \item \textbf{Váº¥n Ä‘á»}: Dá»¯ liá»‡u cáº£m xÃºc thÆ°á»ng bá»‹ máº¥t cÃ¢n báº±ng (Imbalanced Data). 
    VÃ­ dá»¥: NhÃ£n \textit{``Enjoyment''} cÃ³ 1000 cÃ¢u, nhÆ°ng \textit{``Fear''} chá»‰ cÃ³ 100 cÃ¢u. 
    Náº¿u chia ngáº«u nhiÃªn bÃ¬nh thÆ°á»ng, cÃ³ thá»ƒ xáº£y ra trÆ°á»ng há»£p táº­p Test khÃ´ng cÃ³ cÃ¢u \textit{``Fear''} nÃ o, hoáº·c tá»‰ lá»‡ bá»‹ lá»‡ch háº³n so vá»›i thá»±c táº¿.
    
    \item \textbf{Giáº£i phÃ¡p}: Sá»­ dá»¥ng tham sá»‘ \texttt{stratify=self.y} trong hÃ m \texttt{train\_test\_split}.
    
    \item \textbf{TÃ¡c dá»¥ng}: Äáº£m báº£o tá»‰ lá»‡ pháº§n trÄƒm cá»§a cÃ¡c nhÃ£n (Vui, Buá»“n, Giáº­n...) trong táº­p Train vÃ  táº­p Test lÃ  giá»‘ng há»‡t nhau vÃ  giá»‘ng vá»›i táº­p dá»¯ liá»‡u gá»‘c.
\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/KyThuatChia.png}
    \caption{Minh há»a ká»¹ thuáº­t Stratified Random Sampling}
    \label{fig:stratified_sampling}
\end{figure}

\subsection{Logistic Regression}
% Ná»™i dung 3.5.1
s
\subsection{Support Vector Machine}
% Ná»™i dung 3.5.2

\subsection{Naive Bayes}
% Ná»™i dung 3.5.3